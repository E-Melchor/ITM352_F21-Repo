<script src="ProductsData.js"> 
  /*
  This is used to create a sales receipt for a sale that contains at least five different products
  */

 // Product Data
</script>

<script>
var quantities = [1,-2,3,-4,5]
function generate_item_rows(product_quantities_array){
  for(i in products){
        if(product_quantities_array[i]==0)continue; 
          errors = !isNonNegInt(product_quantities_array[i],true)
        if(isNonNegInt(product_quantities_array[i])){
          extended_price = products[i].price*product_quantities_array[i]
            subtotal = subtotal + extended_price
        }else{
          extended_price = ""
        }
            document.write(`
          <tr>
          <td width="43%">${products[i].brand}</td>
          <td align="center" width="11%">${product_quantities_array[i]}<br><font color =red>${errors.join('<br>')}</font></td>
          <td width="13%">$${products[i].price}</td>
          <td width="54%">$${extended_price}</td>
        </tr>
        `);
        }
}

</script>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
  <table border="2">
      <tbody>
        <tr>
          <th style="text-align: center;" width="43%">Item</th>
          <th style="text-align: center;" width="11%">quantity</th>
          <th style="text-align: center;" width="13%">price</th>
          <th style="text-align: center;" width="54%">extended price</th>
        </tr>
        <script>
          subtotal=0;
          generate_item_rows(quantities)
          function isNonNegInt(q, returnErrors= false){
    //validate that an input value is a non-negative integer 
    // q is the input string 
errors = []; // assume no errors at first
if(Number(q) != q) errors.push('Not a number!'); // Check if string is a number value
if(q < 0) errors.push('Negative value!'); // Check if it is non-negative
if(parseInt(q) != q) errors.push('Not an integer!'); // Check that it is an integer
return returnErrors ? errors : (errors.length == 0);
}

  // Compute Sales Tax
  var tax_rate = .0575;
  var sales_tax = subtotal*tax_rate;

  // Compute Shipping
  if (subtotal <=50){
    shipping = 2
  }
  else if (subtotal <=100){
    shipping =5
  }
  else{
    shipping = 0.05*subtotal
  }

  // Compute Grand Total
  var grand_total = subtotal + sales_tax + shipping;
        </script>

        <tr>
          <td colspan="4" width="100%">&nbsp;</td>
        </tr>
        <tr>
          <td style="text-align: center;" colspan="3" width="67%">Sub-total</td>
          <td width="54%"><script>document.write("$"+subtotal)</script></td>
        </tr>
        <tr>
          <td style="text-align: center;" colspan="3" width="67%"><span style="font-family: arial;">Tax @ 5.75%</span></td>
          <td width="54%"><script>document.write("$" + sales_tax.toFixed(2))</script></td>
        </tr>
        <tr>
          <td style="text-align: center;" colspan="3" width="67%"><span style="font-family: arial;">Shipping</span></td>
          <td width="54%"><script>document.write("$" + shipping)</script></td>
        </tr>
        <tr>
          <td style="text-align: center;" colspan="3" width="67%"><strong>Total</strong></td>
          <td width="54%"><strong><script>document.write("$"+ grand_total.toFixed(2))</script></strong></td>
        </tr>
      </tbody>
    </table>
    

</body>
</html>